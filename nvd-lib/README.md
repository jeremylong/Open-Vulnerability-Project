# nvd-lib

A client for the NVD API to retrieve vulnerability data.

An API Key for the NVD API is highly recommended - especially when downloading the  full Vulnerability Catalog from the
NVD. Without an API key downloading takes 10+ minutes; whereas with an API key (and using 4 threads) the entire NVD
Vulnerability Catalog can be downloaded in ~90 seconds.

## usage

### maven

```xml
<dependency>
   <groupId>io.github.jeremylong</groupId>
   <artifactId>nvd-lib</artifactId>
   <version>2.0.2</version>
</dependency>
```

### gradle

```groovy
implementation 'io.github.jeremylong:nvd-lib:2.0.2'
```

### building from source

```shell
./gradlew build
```

### api usage

The API is intended to be fairly simple; an example implementation is given below to retrieve the entire NVD CVE data
set - including a mechanism to keep the data up to date.

```java
import io.github.jeremylong.nvdlib.NvdCveApi;
import io.github.jeremylong.nvdlib.NvdCveApiBuilder;
import io.github.jeremylong.nvdlib.nvd.DefCveItem;

import java.time.ZonedDateTime;
import java.time.ZoneOffset;
import java.util.Collection;

public class Example {

    ZonedDateTime retrieveLastUpdated() {
        // TODO implement a storage/retrieval mechanism.
        return null;
    }

    void storeLasUpdated(ZonedDateTime lastUpdated) {
        // TODO implement a storage/retrieval mechanism.
    }

    public void update() {
        ZonedDateTime lastModifiedRequest = retrieveLastUpdated();
        NvdCveApiBuilder builder = NvdCveApiBuilder.aNvdCveApi();
        if (lastModifiedRequest != null) {
            ZonedDateTime end = lastModifiedRequest.minusDays(-120);
            builder.withLastModifiedFilter(lastModifiedRequest, end);
        }
        //TODO add API key with builder's `withApiKey()`
        //TODO if an API Key is used consider adding `withThreadCount(4)`
        //TODO add any additional filters via the builder's `withFilter()`
        try (NvdCveApi api = builder.build()) {
            while (api.hasNext()) {
                Collection<DefCveItem> items = api.next();
                //TODO do something with the items
            }
            lastModifiedRequest = api.getLastModifiedRequest();
        } catch (Exception e) {
            e.printStackTrace();
        }
        storeLasUpdated(lastModifiedRequest);
    }
}
```